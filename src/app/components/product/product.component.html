<div class="row">
  <div class="col-sm-6">
    <h1>Your products</h1>
    <ul *ngIf="products.length > 0" class="list-unstyled margin-bottom-24">
      <li class="tender padding-12" *ngFor="let product of products">
        <div class="row">
          <div class="col-sm-3 padding-right-0">
            <img class="" width="100%" height="auto" src="data:image/jpg;base64,{{ product.thumbnail | split: ',': 1 }}">
          </div>
          <div class="col-sm-9">
            <ng-container *ngIf="product.user_id == userId">
              <button class="pull-right btn btn-primary btn-xs glyphicon glyphicon-edit" (click)="showUpdateForm(product.id)"></button>
              <button class="pull-right btn btn-danger btn-xs glyphicon glyphicon-trash margin-right-6" (click)="removeProduct(product.id)"></button>
            </ng-container>
            <h4>{{ product.name }}</h4>
            <p><strong>Preis {{ product.price }}</strong></p>
            <p>{{ product.description }}</p>
            <div *ngIf="editField == product.id" id="{{ product.id }}">
              <div class="form-group">
                <label for="{{ product.id }}-name">Name</label><br>
                <input class="form-control" (blur)="updateEntry(product)" [(ngModel)]="product.name" type="text" placeholder="Flowers" name="name" id="{{ product.id }}-name">
              </div>
              <div class="form-group">
                <label for="{{ product.id }}-price">Price</label><br>
                <input class="form-control" (blur)="updateEntry(product)" [(ngModel)]="product.price" type="text" placeholder="37â‚¬" name="price" id="{{ product.id }}-price">
              </div>
              <div class="form-group">
                <label>Category</label>
                <select class="form-control" (blur)="updateEntry(product)" [(ngModel)]="product.category_id" name="category">
                    <option *ngFor="let productCategory of productCategories" [ngValue]="productCategory.id">{{ productCategory.name }}</option>
                  </select>
              </div>
              <div class="form-group">
                <label for="{{ product.id }}-description">Description</label><br>
                <textarea class="form-control" (blur)="updateEntry(product)" [(ngModel)]="product.description" type="text" placeholder="Write a short description about your item" name="description" id="{{ product.id }}-description"></textarea>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ul>
    <p *ngIf="products.length == 0">Hey add your first product!</p>
  </div>
  <div class="col-sm-6 margin-bottom-24">
    <h1>Add product</h1>
    <form [formGroup]="rForm" (ngSubmit)="onUpload()" enctype="multipart/form-data">
      <div class="form-group">
        <label>Name</label>
        <input class="form-control" type="text" formControlName="name">
        <div class="alert margin-top-9" *ngIf="!rForm.controls['name'].valid && rForm.controls['name'].touched">
          {{ errorName }}
        </div>
      </div>
      <div class="form-group">
        <label>Description</label>
        <textarea class="form-control" formControlName="description"></textarea>
        <div class="alert margin-top-9" *ngIf="!rForm.controls['description'].valid && rForm.controls['description'].touched">
          You must specify a description that's between 30 and 500 characters
        </div>
      </div>
      <div class="form-group">
        <label>Price</label>
        <input class="form-control" type="text" formControlName="price">
        <div class="alert margin-top-9" *ngIf="!rForm.controls['price'].valid && rForm.controls['price'].touched">
          You must specify a price.
        </div>
      </div>
      <div class="form-group">
        <label for="thumbnail">Thumbnail</label>
        <input type="file" formControlName="thumbnail" (change)="onFileSelected($event)" name="thumbnail[]" multiple>
      </div>
      <div class="form-group">
        <label>Category</label>
        <select class="form-control" formControlName="category">
            <option *ngFor="let productCategory of productCategories" value="{{ productCategory.id }}">{{ productCategory.name }}</option>
          </select>
        <div class="alert margin-top-9" *ngIf="!rForm.controls['category'].valid && rForm.controls['category'].touched">
          You must choose a category
        </div>
      </div>
      <input type="submit" class="btn btn-primary" value="Save now" [disabled]="!rForm.valid">
    </form>
  </div>
</div>
